<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FLAMES Game - Love Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Bricolage Grotesque', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        /* Simple mobile-first animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1); 
            }
            50% { 
                transform: scale(1.05); 
            }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            50% { transform: translateX(8px); }
            75% { transform: translateX(-4px); }
        }

        @keyframes float {
            0%, 100% { 
                transform: translateY(0); 
            }
            50% { 
                transform: translateY(-10px); 
            }
        }

        .animate-fadeIn {
            animation: fadeIn 0.5s ease forwards;
        }

        .animate-slideUp {
            animation: slideUp 0.4s ease forwards;
        }

        .animate-pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        .animate-shake {
            animation: shake 0.4s ease;
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        /* Smooth scrolling for mobile */
        html {
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        /* Mobile button press effect */
        button:active {
            transform: scale(0.97);
        }

        input:focus {
            transform: scale(1.01);
        }

        /* Safe area for notched phones */
        @supports (padding: max(0px)) {
            body {
                padding-left: max(16px, env(safe-area-inset-left));
                padding-right: max(16px, env(safe-area-inset-right));
            }
        }

        /* Custom gradient background */
        .gradient-bg {
            background: linear-gradient(135deg, #ffeef8 0%, #ffe5f1 25%, #fff0f8 50%, #ffe8f3 75%, #ffedf7 100%);
            position: relative;
        }

        /* Glass morphism effect */
        .glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        /* Soft shadow */
        .soft-shadow {
            box-shadow: 0 8px 32px rgba(255, 105, 180, 0.15);
        }

        /* Gradient text */
        .gradient-text {
            background: linear-gradient(135deg, #ff6b9d 0%, #c44569 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Static decorative background elements */
        .bg-decorations {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .decoration {
            position: absolute;
            opacity: 0.15;
            user-select: none;
        }

        /* Hearts */
        .heart-1 { top: 5%; left: 10%; font-size: 2rem; }
        .heart-2 { top: 15%; right: 15%; font-size: 2.5rem; }
        .heart-3 { top: 25%; left: 5%; font-size: 1.8rem; }
        .heart-4 { top: 35%; right: 8%; font-size: 2.2rem; }
        .heart-5 { top: 50%; left: 12%; font-size: 2rem; }
        .heart-6 { top: 60%; right: 10%; font-size: 2.3rem; }
        .heart-7 { top: 70%; left: 8%; font-size: 1.9rem; }
        .heart-8 { top: 80%; right: 12%; font-size: 2.1rem; }
        .heart-9 { bottom: 10%; left: 15%; font-size: 2.4rem; }
        .heart-10 { bottom: 15%; right: 18%; font-size: 2rem; }

        /* Moon */
        .moon { 
            top: 8%; 
            right: 10%; 
            font-size: 4rem; 
            opacity: 0.2;
        }

        /* Stars */
        .star-1 { top: 12%; left: 25%; font-size: 1.5rem; opacity: 0.2; }
        .star-2 { top: 20%; right: 30%; font-size: 1.2rem; opacity: 0.18; }
        .star-3 { top: 40%; left: 20%; font-size: 1.3rem; opacity: 0.2; }
        .star-4 { top: 55%; right: 25%; font-size: 1.4rem; opacity: 0.18; }
        .star-5 { top: 75%; left: 30%; font-size: 1.2rem; opacity: 0.2; }
        .star-6 { bottom: 20%; right: 35%; font-size: 1.5rem; opacity: 0.18; }

        /* Roses */
        .rose-1 { top: 18%; left: 3%; font-size: 2rem; opacity: 0.12; }
        .rose-2 { top: 45%; right: 3%; font-size: 2.2rem; opacity: 0.12; }
        .rose-3 { bottom: 25%; left: 5%; font-size: 2.1rem; opacity: 0.12; }

        /* Sparkles */
        .sparkle-1 { top: 30%; left: 18%; font-size: 1.5rem; opacity: 0.15; }
        .sparkle-2 { top: 48%; right: 20%; font-size: 1.3rem; opacity: 0.15; }
        .sparkle-3 { top: 65%; left: 22%; font-size: 1.4rem; opacity: 0.15; }
        .sparkle-4 { bottom: 30%; right: 22%; font-size: 1.6rem; opacity: 0.15; }

        /* Cupid */
        .cupid { 
            top: 10%; 
            left: 50%; 
            transform: translateX(-50%);
            font-size: 3rem; 
            opacity: 0.12;
        }

        /* Mobile adjustments */
        @media (max-width: 640px) {
            .moon { font-size: 3rem; }
            .cupid { font-size: 2.5rem; }
            .heart-1, .heart-2, .heart-3, .heart-4, .heart-5,
            .heart-6, .heart-7, .heart-8, .heart-9, .heart-10 {
                font-size: 1.5rem !important;
            }
            .rose-1, .rose-2, .rose-3 {
                font-size: 1.5rem !important;
            }
            .star-1, .star-2, .star-3, .star-4, .star-5, .star-6 {
                font-size: 1rem !important;
            }
            .sparkle-1, .sparkle-2, .sparkle-3, .sparkle-4 {
                font-size: 1rem !important;
            }
        }

        /* Success notification */
        .success-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            z-index: 1000;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen relative overflow-x-hidden">
    
    <!-- Success Toast -->
    <div id="successToast" class="success-toast">
        ‚úÖ Result saved successfully!
    </div>

    <!-- Static Decorative Background -->
    <div class="bg-decorations">
        <!-- Moon -->
        <div class="decoration moon">üåô</div>
        
        <!-- Cupid -->
        <div class="decoration cupid">üíò</div>
        
        <!-- Hearts -->
        <div class="decoration heart-1">üíï</div>
        <div class="decoration heart-2">üíñ</div>
        <div class="decoration heart-3">üíó</div>
        <div class="decoration heart-4">üíì</div>
        <div class="decoration heart-5">üíù</div>
        <div class="decoration heart-6">‚ù§Ô∏è</div>
        <div class="decoration heart-7">üíï</div>
        <div class="decoration heart-8">üíû</div>
        <div class="decoration heart-9">üíñ</div>
        <div class="decoration heart-10">üíó</div>
        
        <!-- Stars -->
        <div class="decoration star-1">‚≠ê</div>
        <div class="decoration star-2">‚ú®</div>
        <div class="decoration star-3">‚≠ê</div>
        <div class="decoration star-4">‚ú®</div>
        <div class="decoration star-5">‚≠ê</div>
        <div class="decoration star-6">‚ú®</div>
        
        <!-- Roses -->
        <div class="decoration rose-1">üåπ</div>
        <div class="decoration rose-2">üåπ</div>
        <div class="decoration rose-3">üåπ</div>
        
        <!-- Sparkles -->
        <div class="decoration sparkle-1">‚ú®</div>
        <div class="decoration sparkle-2">üí´</div>
        <div class="decoration sparkle-3">‚ú®</div>
        <div class="decoration sparkle-4">üí´</div>
    </div>

    <div class="container mx-auto px-4 py-6 sm:py-8 max-w-lg relative z-10">
        
        <!-- Header -->
        <div class="text-center mb-6 sm:mb-8 animate-fadeIn">
            <div class="mb-4">
                <span class="text-6xl sm:text-7xl animate-pulse">üíï</span>
            </div>
            <h1 class="text-5xl sm:text-6xl font-bold mb-2 gradient-text">FLAMES</h1>
            <p class="text-base sm:text-lg text-pink-600 font-medium">Test Your Love Connection</p>
        </div>

        <!-- Input Card -->
        <div class="glass rounded-3xl soft-shadow p-6 sm:p-8 mb-5 sm:mb-6 border border-pink-100 animate-fadeIn">
            
            <!-- Error Message -->
            <div id="errorMessage" class="hidden bg-red-50 border border-red-200 text-red-700 p-3 sm:p-4 rounded-xl mb-4 sm:mb-6 animate-shake">
                <div class="flex items-center">
                    <span class="text-xl sm:text-2xl mr-3">‚ö†Ô∏è</span>
                    <p class="font-semibold text-sm sm:text-base" id="errorText"></p>
                </div>
            </div>

            <!-- Input Groups -->
            <div class="space-y-5 sm:space-y-6">
                <div>
                    <label for="name1" class="block text-sm sm:text-base font-semibold text-gray-700 mb-2">
                        Your Name
                    </label>
                    <input 
                        type="text" 
                        id="name1" 
                        placeholder="Enter your name" 
                        class="w-full px-4 sm:px-5 py-3 sm:py-4 border-2 border-pink-200 rounded-xl text-base sm:text-lg focus:outline-none focus:border-pink-400 focus:ring-2 focus:ring-pink-100 transition-all duration-300 bg-white text-gray-800 font-medium"
                        autocomplete="off"
                    >
                </div>

                <div class="flex justify-center">
                    <div class="w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center">
                        <span class="text-2xl animate-float">‚ù§Ô∏è</span>
                    </div>
                </div>

                <div>
                    <label for="name2" class="block text-sm sm:text-base font-semibold text-gray-700 mb-2">
                        Their Name
                    </label>
                    <input 
                        type="text" 
                        id="name2" 
                        placeholder="Enter their name" 
                        class="w-full px-4 sm:px-5 py-3 sm:py-4 border-2 border-pink-200 rounded-xl text-base sm:text-lg focus:outline-none focus:border-pink-400 focus:ring-2 focus:ring-pink-100 transition-all duration-300 bg-white text-gray-800 font-medium"
                        autocomplete="off"
                    >
                </div>
            </div>

            <!-- Calculate Button -->
            <button 
                onclick="calculateFlames()" 
                class="w-full mt-6 sm:mt-8 bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 text-white text-base sm:text-lg font-bold py-4 sm:py-5 rounded-xl shadow-lg transition-all duration-300 active:scale-95"
            >
                Calculate FLAMES ‚ú®
            </button>
        </div>

        <!-- Result Card -->
        <div id="resultCard" class="hidden glass rounded-3xl soft-shadow p-6 sm:p-8 mb-5 sm:mb-6 border border-pink-100 animate-slideUp">
            <div class="text-center">
                <div id="resultIcon" class="text-7xl sm:text-8xl mb-4 sm:mb-5 animate-pulse">‚ù§Ô∏è</div>
                <h2 id="resultTitle" class="text-4xl sm:text-5xl font-bold mb-3 sm:mb-4 gradient-text">Love</h2>
                <p id="resultDescription" class="text-base sm:text-lg text-gray-700 mb-6 sm:mb-8 leading-relaxed font-medium"></p>
                
                <div class="space-y-3 sm:space-y-4">
                    <button 
                        onclick="resetGame()" 
                        class="w-full bg-gradient-to-r from-pink-500 to-rose-500 hover:from-pink-600 hover:to-rose-600 text-white text-base sm:text-lg font-bold py-3 sm:py-4 rounded-xl shadow-lg transition-all duration-300 active:scale-95"
                    >
                        Try Again üíï
                    </button>
                    <button 
                        onclick="toggleProcess()" 
                        class="w-full bg-white hover:bg-pink-50 text-pink-600 text-base sm:text-lg font-semibold py-3 sm:py-4 rounded-xl border-2 border-pink-200 transition-all duration-300 active:scale-95"
                    >
                        Show Process üìù
                    </button>
                </div>
            </div>
        </div>

        <!-- Process Card -->
        <div id="processCard" class="hidden glass rounded-3xl soft-shadow p-6 sm:p-8 border border-pink-100 animate-slideUp">
            <h2 class="text-2xl sm:text-3xl font-bold text-center mb-6 sm:mb-8 gradient-text">
                Calculation Process
            </h2>
            <div id="processSteps" class="space-y-4"></div>
        </div>

    </div>

    <script>
       // ========================================
// SUPABASE CONFIGURATION
// ========================================
const SUPABASE_URL = 'https://ccmxlawvzfdozfphguun.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNjbXhsYXd2emZkb3pmcGhndXVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1NjM5MDYsImV4cCI6MjA4MDEzOTkwNn0.jHZ8TOkCj5TE6IfsVvpTf4dTjRHkA5pw2J9zUmqalm0';

// Initialize Supabase client (use window.supabase from CDN)
const { createClient } = supabase;
const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

// ========================================
// FLAMES DATA
// ========================================
const flamesData = {
    'F': {
        title: 'Friendship',
        icon: 'ü§ù',
        description: 'You two are destined to be wonderful friends! A strong bond of friendship awaits.'
    },
    'L': {
        title: 'Love',
        icon: '‚ù§Ô∏è',
        description: 'True love is blooming! You share a deep romantic connection that\'s meant to be.'
    },
    'A': {
        title: 'Affection',
        icon: 'üíï',
        description: 'Sweet affection flows between you! Care and warmth define your bond.'
    },
    'M': {
        title: 'Marriage',
        icon: 'üíç',
        description: 'Wedding bells are ringing! You two are destined to be life partners.'
    },
    'E': {
        title: 'Enemies',
        icon: 'üò§',
        description: 'Opposite energies clash here. Challenges may arise in your relationship.'
    },
    'S': {
        title: 'Siblings',
        icon: 'üë´',
        description: 'You share a sibling-like bond full of teasing and unconditional support.'
    }
};

let processData = {};

// ========================================
// SUPABASE FUNCTIONS
// ========================================
async function saveToSupabase(name1, name2, result, resultTitle) {
    try {
        const { data, error } = await supabaseClient
            .from('flames_results')
            .insert([
                {
                    name1: name1,
                    name2: name2,
                    result: result,
                    result_title: resultTitle
                }
            ]);

        if (error) {
            console.error('Error saving to Supabase:', error);
            return false;
        } else {
            console.log('Successfully saved to Supabase!', data);
            showSuccessToast();
            return true;
        }
    } catch (err) {
        console.error('Exception saving to Supabase:', err);
        return false;
    }
}

function showSuccessToast() {
    const toast = document.getElementById('successToast');
    toast.style.display = 'block';
    
    setTimeout(() => {
        toast.style.display = 'none';
    }, 3000);
}

// ========================================
// GAME FUNCTIONS
// ========================================
function showError(message) {
    const errorElement = document.getElementById('errorMessage');
    const errorText = document.getElementById('errorText');
    errorText.textContent = message;
    errorElement.classList.remove('hidden');
    errorElement.classList.add('animate-shake');
    
    // Haptic feedback for mobile
    if (navigator.vibrate) {
        navigator.vibrate(200);
    }
    
    setTimeout(() => {
        errorElement.classList.add('hidden');
        errorElement.classList.remove('animate-shake');
    }, 3000);
}

async function calculateFlames() {
    const name1Input = document.getElementById('name1').value.trim();
    const name2Input = document.getElementById('name2').value.trim();
    const name1 = name1Input.toLowerCase().replace(/\s+/g, '');
    const name2 = name2Input.toLowerCase().replace(/\s+/g, '');

    // Validation
    if (!name1 || !name2) {
        showError('Please enter both names!');
        return;
    }

    if (!/^[a-z]+$/.test(name1) || !/^[a-z]+$/.test(name2)) {
        showError('Please use only letters!');
        return;
    }

    if (name1 === name2) {
        showError('Please enter different names!');
        return;
    }

    // Haptic feedback for success
    if (navigator.vibrate) {
        navigator.vibrate([50, 30, 50]);
    }

    // Process calculation
    const result = processFlames(name1, name2);
    const resultTitle = flamesData[result].title;
    
    // Display result
    displayResult(result);

    // Save to Supabase (with original capitalization)
    await saveToSupabase(name1Input, name2Input, result, resultTitle);
}

function processFlames(name1, name2) {
    let arr1 = name1.split('');
    let arr2 = name2.split('');
    
    const original1 = name1;
    const original2 = name2;

    // Remove common letters
    let commonLetters = [];
    for (let i = arr1.length - 1; i >= 0; i--) {
        const letter = arr1[i];
        const index2 = arr2.indexOf(letter);
        
        if (index2 !== -1) {
            commonLetters.push(letter);
            arr1.splice(i, 1);
            arr2.splice(index2, 1);
        }
    }

    const remaining1 = arr1.join('');
    const remaining2 = arr2.join('');
    const totalCount = arr1.length + arr2.length;

    // FLAMES elimination
    let flames = ['F', 'L', 'A', 'M', 'E', 'S'];
    let eliminationSteps = [];
    let currentIndex = 0;

    while (flames.length > 1) {
        currentIndex = (currentIndex + totalCount - 1) % flames.length;
        const eliminated = flames.splice(currentIndex, 1)[0];
        eliminationSteps.push({
            eliminated: eliminated,
            remaining: [...flames]
        });
        
        if (currentIndex >= flames.length && flames.length > 0) {
            currentIndex = 0;
        }
    }

    const finalResult = flames[0];

    // Store process data
    processData = {
        original1: original1,
        original2: original2,
        remaining1: remaining1,
        remaining2: remaining2,
        commonLetters: commonLetters,
        totalCount: totalCount,
        eliminationSteps: eliminationSteps,
        finalResult: finalResult
    };

    return finalResult;
}

function displayResult(result) {
    const resultCard = document.getElementById('resultCard');
    const resultIcon = document.getElementById('resultIcon');
    const resultTitle = document.getElementById('resultTitle');
    const resultDescription = document.getElementById('resultDescription');

    const data = flamesData[result];
    
    resultIcon.textContent = data.icon;
    resultTitle.textContent = data.title;
    resultDescription.textContent = data.description;

    resultCard.classList.remove('hidden');
    
    setTimeout(() => {
        resultCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }, 100);
}

function resetGame() {
    document.getElementById('name1').value = '';
    document.getElementById('name2').value = '';
    document.getElementById('resultCard').classList.add('hidden');
    document.getElementById('processCard').classList.add('hidden');
    document.getElementById('name1').focus();
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function toggleProcess() {
    const processCard = document.getElementById('processCard');
    const processSteps = document.getElementById('processSteps');

    if (!processCard.classList.contains('hidden')) {
        processCard.classList.add('hidden');
        return;
    }

    // Build process HTML
    let html = '';

    // Step 1
    html += `
        <div class="bg-pink-50 p-4 sm:p-5 rounded-xl border border-pink-200">
            <h3 class="text-base sm:text-lg font-bold text-pink-700 mb-2">
                Step 1: Original Names
            </h3>
            <p class="text-sm sm:text-base text-gray-700 font-medium"><strong>Name 1:</strong> ${processData.original1}</p>
            <p class="text-sm sm:text-base text-gray-700 font-medium"><strong>Name 2:</strong> ${processData.original2}</p>
        </div>
    `;

    // Step 2
    html += `
        <div class="bg-pink-50 p-4 sm:p-5 rounded-xl border border-pink-200">
            <h3 class="text-base sm:text-lg font-bold text-pink-700 mb-2">
                Step 2: Remove Common Letters
            </h3>
            <p class="text-sm sm:text-base text-gray-700 font-medium"><strong>Common letters:</strong> ${processData.commonLetters.join(', ') || 'none'}</p>
            <p class="text-sm sm:text-base text-gray-700 font-medium"><strong>Remaining 1:</strong> ${processData.remaining1 || 'none'}</p>
            <p class="text-sm sm:text-base text-gray-700 font-medium"><strong>Remaining 2:</strong> ${processData.remaining2 || 'none'}</p>
            <p class="text-sm sm:text-base text-gray-700 font-bold mt-2"><strong>Total count:</strong> ${processData.totalCount}</p>
        </div>
    `;

    // Step 3
    html += `
        <div class="bg-pink-50 p-4 sm:p-5 rounded-xl border border-pink-200">
            <h3 class="text-base sm:text-lg font-bold text-pink-700 mb-2">
                Step 3: FLAMES Elimination
            </h3>
            <p class="text-sm sm:text-base text-gray-700 font-medium mb-2">Count ${processData.totalCount} and eliminate:</p>
    `;

    processData.eliminationSteps.forEach((step, index) => {
        html += `<p class="text-sm sm:text-base text-gray-700 font-medium">Round ${index + 1}: Eliminated <strong class="text-pink-600">${step.eliminated}</strong> ‚Üí Remaining: <strong>${step.remaining.join(', ')}</strong></p>`;
    });

    html += `</div>`;

    // Final result
    html += `
        <div class="bg-gradient-to-r from-pink-100 to-rose-100 p-4 sm:p-5 rounded-xl border border-pink-300">
            <h3 class="text-base sm:text-lg font-bold text-pink-800 mb-2">
                Final Result
            </h3>
            <p class="text-sm sm:text-base text-gray-800 font-bold">Last remaining letter: <strong class="text-xl sm:text-2xl text-pink-600">${processData.finalResult}</strong></p>
            <p class="text-base sm:text-lg text-gray-800 font-bold mt-2">${flamesData[processData.finalResult].title}</p>
        </div>
    `;

    processSteps.innerHTML = html;
    processCard.classList.remove('hidden');
    
    setTimeout(() => {
        processCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }, 100);
}

// Keyboard handling
document.getElementById('name2').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        e.preventDefault();
        this.blur();
        calculateFlames();
    }
});

document.getElementById('name1').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        e.preventDefault();
        document.getElementById('name2').focus();
    }
});

// Prevent zoom on double tap
let lastTouchEnd = 0;
document.addEventListener('touchend', function(event) {
    const now = Date.now();
    if (now - lastTouchEnd <= 300) {
        event.preventDefault();
    }
    lastTouchEnd = now;
}, false);

    </script>
</body>
</html>
